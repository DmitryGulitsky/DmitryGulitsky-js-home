<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>homework</title>
  <script src='http://code.jquery.com/jquery-latest.js'></script>
  <script src="script.js"></script>
</head>
<body>
<div id="page"></div>

<script>
  'use strict';

  window.onhashchange = renderNewState;

  let page = document.getElementById('page');

  function renderNewState() {
    const hash = window.location.hash;
    let state = decodeURIComponent(hash.substr(1));

    if (state === '') {
      state = {page: 'first'};
    } else {
      state = JSON.parse(state);
    }



    switch(state.page) {
      case 'first':

        let firstPageHeader = document.createElement('h1');
        page.appendChild(firstPageHeader);
        firstPageHeader.className = 'pageHeader';
        firstPageHeader.textContent = 'Энциклопедия';


        let firstPageLink = document.createElement('a');
        page.appendChild(firstPageLink);
        firstPageHeader.className = 'pageLink';
        firstPageLink.textContent = 'список статей здесь';

        firstPageLink.addEventListener('click', function() {
          switchToSecond();

        });

        break;

      case 'second':

        let secondPageHeader = document.createElement('h1');
        page.appendChild(secondPageHeader);
        secondPageHeader.className = 'pageHeader';
        secondPageHeader.textContent = 'Оглавление';

        let secondPageLinkContainer = document.createElement('div');
        page.appendChild(secondPageLinkContainer);


        $.ajax(AjaxHandlerScript, {
          type: 'GET', dataType: 'json',
          data: {func: 'COURSES_JSON'},
          success: CoursesListReady, error: ErrorHandler
        });

      function CoursesListReady(data) {

        console.log('От сервера получен ответ:');
        console.log(data);

        var CoursesA = data;

        var byName = CoursesA.slice(0);
        byName.sort(function(a,b) {
          var x = a.name.toLowerCase();
          var y = b.name.toLowerCase();
          return x < y ? -1 : x > y ? 1 : 0;
        });

        console.log('by name:');
        console.log(byName);

        var OptionsStr = '';

        var listLetter = '';

        for (var C = 0; C < byName.length; C++) {
          var CourseH = byName[C];

          console.log(CourseH.name);

          if (listLetter != CourseH.name.charAt(0).toLocaleUpperCase()) {

            listLetter = CourseH.name.charAt(0).toLocaleUpperCase();

            OptionsStr += '<p><strong>' + listLetter + '</p></strong>';
          }


          console.log(CourseH.name.charAt(0).toLocaleUpperCase());
          OptionsStr += '<a>' + CourseH.name + '</a><br>';

        }

        secondPageLinkContainer.innerHTML = OptionsStr;
      }

        break;

      case 'third':

        let thirdPageHeader = document.createElement('h1');
        page.appendChild(thirdPageHeader);
        thirdPageHeader.className = 'pageHeader';
        thirdPageHeader.textContent = 'Название статьи';

        break;
    }

  }

  function switchToState(state) {
    location.hash = encodeURIComponent(JSON.stringify(state));
  }
  function switchToFirst() {
    switchToState({page: 'first'});
    pageContentRemove();
  }
  function switchToSecond() {
    switchToState({page: 'second'});
    pageContentRemove();
  }
  function switchToThird() {
    switchToState({page: 'third'});
    pageContentRemove();
  }

  function pageContentRemove() {
    while (page.firstChild) {
      page.removeChild(page.firstChild);
    }
  }

  renderNewState();
</script>

<input type="button" value="First" onclick="switchToFirst()">
<input type="button" value="Second" onclick="switchToSecond()">
<input type="button" value="Third" onclick="switchToThird()">
</body>
</html>